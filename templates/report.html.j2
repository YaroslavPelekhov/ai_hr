<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Отчет по кандидату {{ resume.name or resume.candidate_id }}</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; line-height: 1.45; }
    header { border-bottom: 1px solid #ccc; margin-bottom: 16px; padding-bottom: 8px; }
    h1 { margin: 0; font-size: 22px; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .card { border: 1px solid #ddd; border-radius: 10px; padding: 12px; }
    .tag { display: inline-block; border: 1px solid #bbb; border-radius: 999px; padding: 2px 8px; margin: 2px; font-size: 12px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border-bottom: 1px solid #eee; padding: 8px; text-align: left; vertical-align: top; }
    .ok { color: #0a8; }
    .warn { color: #d70; }
  </style>
</head>
<body>
  <header>
    <h1>Отчет по кандидату: {{ resume.name or resume.candidate_id }}</h1>
    <div>Контакты: {{ resume.emails|join(", ") }} | {{ resume.phones|join(", ") }} | TG: {{ resume.telegrams|join(", ") }}</div>
  </header>

  <section class="grid">
    <div class="card">
      <h3>Сводка</h3>
      <p><strong>Скоринг:</strong> {{ "%.2f"|format(match.score) }}</p>
      <p><strong>Причины:</strong> {{ match.reasons|join("; ") }}</p>
      <p><strong>Навыки:</strong>
        {% for s in resume.skills %}<span class="tag">{{ s }}</span>{% endfor %}
      </p>
    </div>
    <div class="card">
      <h3>Решение</h3>
      <p><strong>Статус:</strong>
        {% if outcome.decision == "hire" %}<span class="ok">Hire</span>
        {% elif outcome.decision == "no_hire" %}<span class="warn">No hire</span>
        {% else %}<span>Hold</span>{% endif %}
      </p>
      <p><strong>Обоснование:</strong> {{ outcome.rationale }}</p>
    </div>
  </section>

  <section class="card" style="margin-top:16px;">
    <h3>Транскрипт собеседования</h3>
    <table>
      <thead><tr><th>Кто</th><th>Текст</th></tr></thead>
      <tbody>
      {% for turn in outcome.transcript %}
        <tr><td>{{ "AI‑HR" if turn.role=="ai" else "Кандидат" }}</td><td>{{ turn.text }}</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </section>

  <section class="card" style="margin-top:16px;">
    <h3>Исходный текст резюме</h3>
    <p>{{ resume.raw_text }}</p>
  </section>
</body>
</html>
